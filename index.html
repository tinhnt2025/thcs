<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>·ª®ng d·ª•ng v√† tr·ª£ l√Ω ·∫£o tr√≠ tu·ªá nh√¢n t·∫°o h·ªçc t·∫≠p trong tr∆∞·ªùng THCS</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Quicksand:wght@400;500;600&display=swap');

        body {
            font-family: 'Quicksand', sans-serif;
            margin: 0;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            background: linear-gradient(135deg, #e0f7fa 0%, #bbdefb 100%);
            color: #333;
            overflow: auto;
        }

        /* Th√™m style cho header ch·ª©a logo */
        .header {
            display: flex;
            align-items: center;
            padding: 10px 20px;
            background-color: rgba(255, 255, 255, 0.95);
            box-shadow: 0 2px 15px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
        }

        .logo-container {
            display: flex;
            align-items: center;
        }

        .logo {
            height: 50px;
            margin-right: 15px;
            border-radius: 8px;
        }

        .school-name {
            font-size: 1.2em;
            font-weight: 600;
            color: #26a69a;
        }

        /* Th√™m style cho footer */
        .footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 20px;
            background-color: rgba(255, 255, 255, 0.95);
            border-top: 1px solid #e0e0e0;
            box-shadow: 0 -2px 15px rgba(0,0,0,0.1);
            font-size: 0.9em;
            backdrop-filter: blur(10px);
        }

        .footer-content {
            flex-grow: 1;
            text-align: center;
            font-weight: bold;
        }

        /* Th√™m style cho logo l·ªõn ·ªü trang ch·ªß */
        .homepage-main-logo {
            height: 150px;
            margin-bottom: 20px;
            border-radius: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }

        .homepage-main-logo:hover {
            transform: scale(1.05);
        }

        #home-menu {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            flex-grow: 1;
            padding: 30px 20px;
            text-align: center;
            background-color: rgba(255, 255, 255, 0.9);
            box-shadow: 0 8px 32px rgba(31, 38, 135, 0.1);
            border-radius: 20px;
            margin: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        #home-menu h1 {
            color: #26a69a;
            margin-bottom: 20px;
            font-size: 2.2em;
            background: linear-gradient(45deg, #26a69a, #4CAF50);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        .welcome-text {
            color: #666;
            font-size: 1.1em;
            margin-bottom: 30px;
            max-width: 800px;
            line-height: 1.6;
        }

        /* Game Section Styles */
        .game-section {
            width: 100%;
            max-width: 1200px;
            margin: 30px 0;
            padding: 20px;
        }

        .section-title {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            color: #26a69a;
            font-size: 1.8em;
            margin-bottom: 30px;
            text-align: center;
        }

        .section-title i {
            color: #FF6B6B;
            font-size: 1.5em;
        }

        .game-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
            width: 100%;
        }

        .game-card {
            background: linear-gradient(145deg, #ffffff, #f0f0f0);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.5);
            position: relative;
            overflow: hidden;
        }

        .game-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.15);
        }

        .game-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(90deg, #FF6B6B, #4ECDC4, #45B7D1);
        }

        .game-icon {
            font-size: 3em;
            margin-bottom: 15px;
            background: linear-gradient(45deg, #FF6B6B, #FFD166);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .game-title {
            color: #333;
            font-size: 1.4em;
            font-weight: 600;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .game-description {
            color: #666;
            font-size: 0.95em;
            line-height: 1.5;
            margin-bottom: 20px;
            min-height: 60px;
        }

        .play-button {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            background: linear-gradient(45deg, #4CAF50, #2E7D32);
            color: white;
            border: none;
            border-radius: 50px;
            padding: 12px 25px;
            font-size: 1em;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            width: 100%;
            box-shadow: 0 4px 15px rgba(76, 175, 80, 0.3);
        }

        .play-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(76, 175, 80, 0.4);
            background: linear-gradient(45deg, #2E7D32, #4CAF50);
        }

        .play-button i {
            font-size: 1.2em;
        }

        /* Subject Buttons Styles */
        .subject-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 20px;
            width: 80%;
            max-width: 900px;
        }

        .subject-button {
            background: linear-gradient(145deg, #4CAF50, #2E7D32);
            color: white;
            border: none;
            border-radius: 15px;
            padding: 20px;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 6px 20px rgba(76, 175, 80, 0.3);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
        }

        .subject-button i {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .subject-button:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(76, 175, 80, 0.4);
            background: linear-gradient(145deg, #2E7D32, #4CAF50);
        }

        /* Chatbot Container Styles */
        #chatbot-container {
            display: none;
            flex-grow: 1;
            flex-direction: row;
            overflow: hidden;
            background-color: rgba(255, 255, 255, 0.95);
            box-shadow: 0 8px 32px rgba(31, 38, 135, 0.1);
            border-radius: 20px;
            margin: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        #sidebar {
            width: 200px;
            background: linear-gradient(145deg, #f0f4c3, #e6ee9c);
            padding: 20px;
            border-right: 1px solid #dce775;
            display: flex;
            flex-direction: column;
            box-shadow: inset -2px 0 10px rgba(0,0,0,0.05);
            border-radius: 20px 0 0 20px;
        }

        #sidebar h3 {
            color: #689f38;
            margin-top: 0;
            margin-bottom: 25px;
            text-align: center;
            font-size: 1.3em;
            font-weight: 600;
        }

        .sidebar-button {
            background: linear-gradient(145deg, #c5e1a5, #aed581);
            color: #333;
            border: none;
            border-radius: 12px;
            padding: 12px 15px;
            margin-bottom: 12px;
            font-size: 0.95em;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
            display: flex;
            align-items: center;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }

        .sidebar-button i {
            margin-right: 10px;
            font-size: 1.2em;
            min-width: 20px;
        }

        .sidebar-button.active, .sidebar-button:hover {
            background: linear-gradient(145deg, #8bc34a, #7cb342);
            color: white;
            transform: translateX(5px);
            box-shadow: 0 5px 15px rgba(139, 195, 74, 0.3);
        }

        .chat-area {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        #khung-tro-chuyen {
            flex-grow: 1;
            overflow-y: auto;
            padding: 20px;
            background: linear-gradient(145deg, #ffffff, #f5f5f5);
            display: flex;
            flex-direction: column;
        }

        .tin-nhan {
            margin-bottom: 15px;
            padding: 12px 18px;
            border-radius: 25px;
            max-width: 75%;
            position: relative;
            word-wrap: break-word;
            line-height: 1.4;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .tin-nhan-nguoi-dung {
            background: linear-gradient(145deg, #007bff, #0056b3);
            color: white;
            margin-left: auto;
            text-align: right;
            border-bottom-right-radius: 8px;
            box-shadow: 0 4px 15px rgba(0, 123, 255, 0.3);
        }

        .tin-nhan-bot {
            background: linear-gradient(145deg, #e3f2fd, #bbdefb);
            color: #212121;
            margin-right: auto;
            text-align: left;
            border-bottom-left-radius: 8px;
            box-shadow: 0 4px 15px rgba(33, 150, 243, 0.2);
        }

        #khu-vuc-nhap {
            display: flex;
            padding: 20px;
            background: linear-gradient(145deg, #ffffff, #f5f5f5);
            border-top: 1px solid rgba(224, 224, 224, 0.5);
            align-items: center;
        }

        #o-nhap-tin-nhan {
            flex-grow: 1;
            padding: 15px 20px;
            border: 2px solid #c5e1a5;
            border-radius: 30px;
            outline: none;
            font-size: 16px;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.9);
        }

        #o-nhap-tin-nhan:focus {
            border-color: #8bc34a;
            box-shadow: 0 0 0 4px rgba(139, 195, 74, 0.2);
        }

        #nut-gui {
            background: linear-gradient(145deg, #4CAF50, #2E7D32);
            color: white;
            border: none;
            border-radius: 50%;
            width: 55px;
            height: 55px;
            margin-left: 15px;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 24px;
            box-shadow: 0 6px 20px rgba(76, 175, 80, 0.3);
            transition: all 0.3s ease;
        }

        #nut-gui:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(76, 175, 80, 0.4);
            background: linear-gradient(145deg, #2E7D32, #4CAF50);
        }

        #nut-gui:active {
            transform: translateY(0);
            box-shadow: 0 4px 15px rgba(76, 175, 80, 0.3);
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .game-cards {
                grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
                gap: 20px;
            }
            
            .game-card {
                padding: 20px;
            }
            
            .subject-buttons {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
                gap: 15px;
                width: 95%;
            }
            
            .section-title {
                font-size: 1.6em;
            }
        }

        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                padding: 15px;
            }
            
            .logo-container {
                margin-bottom: 10px;
                flex-direction: column;
                text-align: center;
            }
            
            .logo {
                margin-right: 0;
                margin-bottom: 10px;
                height: 45px;
            }
            
            .footer {
                flex-direction: column;
                text-align: center;
                padding: 15px;
            }
            
            .homepage-main-logo {
                height: 120px;
            }
            
            #home-menu {
                margin: 15px;
                padding: 20px 15px;
            }

            #home-menu h1 {
                font-size: 1.8em;
                margin-bottom: 15px;
            }

            .welcome-text {
                font-size: 1em;
                padding: 0 10px;
            }

            .game-section {
                padding: 15px 10px;
                margin: 20px 0;
            }

            .game-cards {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .game-card {
                padding: 15px;
            }

            .game-title {
                font-size: 1.2em;
            }

            .game-description {
                font-size: 0.9em;
                min-height: 50px;
            }

            .play-button {
                padding: 10px 20px;
                font-size: 0.95em;
            }

            .subject-buttons {
                grid-template-columns: repeat(auto-fit, minmax(130px, 1fr));
                gap: 12px;
            }

            .subject-button {
                padding: 15px;
                font-size: 1em;
            }

            .subject-button i {
                font-size: 2em;
                margin-bottom: 8px;
            }

            #chatbot-container {
                flex-direction: column;
                margin: 15px;
                border-radius: 15px;
            }

            #sidebar {
                width: 100%;
                height: auto;
                border-right: none;
                border-bottom: 1px solid #dce775;
                padding: 15px;
                border-radius: 15px 15px 0 0;
                flex-direction: row;
                overflow-x: auto;
                white-space: nowrap;
                -webkit-overflow-scrolling: touch;
            }

            #sidebar h3 {
                display: none;
            }

            .sidebar-button {
                flex-shrink: 0;
                width: auto;
                margin-bottom: 0;
                margin-right: 10px;
                padding: 10px 15px;
                font-size: 0.9em;
            }

            .sidebar-button i {
                font-size: 1.1em;
                margin-right: 5px;
            }

            .chat-area {
                min-height: 0;
            }

            #khung-tro-chuyen {
                padding: 15px;
            }

            .tin-nhan {
                max-width: 85%;
                padding: 10px 15px;
                font-size: 0.9em;
                margin-bottom: 12px;
            }

            #khu-vuc-nhap {
                padding: 15px;
            }

            #o-nhap-tin-nhan {
                padding: 12px 18px;
                font-size: 14px;
            }

            #nut-gui {
                width: 50px;
                height: 50px;
                font-size: 20px;
                margin-left: 10px;
            }
        }

        @media (max-width: 480px) {
            #home-menu h1 {
                font-size: 1.6em;
            }
            
            .section-title {
                font-size: 1.4em;
            }
            
            .game-title {
                font-size: 1.1em;
            }
            
            .subject-buttons {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .subject-button {
                padding: 12px;
                font-size: 0.9em;
            }
            
            .subject-button i {
                font-size: 1.8em;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="logo-container">
            <img src="https://images.squarespace-cdn.com/content/v1/590b1f48e6f2e17836ea5649/bc0bccc3-bb7d-4dd8-ad86-6061f990a3b2/20240918-01.png?format=2500w" alt="Logo tr∆∞·ªùng THCS Nguy·ªÖn Tri Ph∆∞∆°ng" class="logo">
            <div class="school-name">THCS Nguy·ªÖn Tri Ph∆∞∆°ng</div>
        </div>
    </div>

    <div id="home-menu">
        <img src="https://images.squarespace-cdn.com/content/v1/590b1f48e6f2e17836ea5649/bc0bccc3-bb7d-4dd8-ad86-6061f990a3b2/20240918-01.png?format=2500w" 
             alt="Logo tr∆∞·ªùng THCS Nguy·ªÖn Tri Ph∆∞∆°ng" 
             class="homepage-main-logo">
        <h1>·ª®ng d·ª•ng v√† tr·ª£ l√Ω ·∫£o tr√≠ tu·ªá nh√¢n t·∫°o h·ªçc t·∫≠p trong tr∆∞·ªùng THCS</h1>
        
        <p class="welcome-text">
            Ch√†o m·ª´ng b·∫°n ƒë·∫øn v·ªõi h·ªá th·ªëng h·ªçc t·∫≠p th√¥ng minh. Ch·ªçn m√¥n h·ªçc ƒë·ªÉ b·∫Øt ƒë·∫ßu t∆∞∆°ng t√°c v·ªõi AI,
            ho·∫∑c kh√°m ph√° c√°c tr√≤ ch∆°i gi√°o d·ª•c th√∫ v·ªã b√™n d∆∞·ªõi!
        </p>

        <!-- Game Section -->
        <div class="game-section">
            <div class="section-title">
                <i class="fas fa-gamepad"></i>
                TR√í CH∆†I GI√ÅO D·ª§C TH√îNG MINH
            </div>
            
            <div class="game-cards">
                <!-- Game 1 -->
                <div class="game-card">
                    <div class="game-icon">
                        <i class="fas fa-robot"></i>
                    </div>
                    <div class="game-title">
                        <i class="fas fa-star"></i>
                        AI To√°n H·ªçc Th√¥ng Minh
                    </div>
                    <div class="game-description">
                        Kh√°m ph√° th·∫ø gi·ªõi to√°n h·ªçc qua tr√≤ ch∆°i t∆∞∆°ng t√°c v·ªõi AI. Gi·∫£i ƒë·ªë, t√≠nh to√°n v√† r√®n luy·ªán t∆∞ duy logic qua c√°c th·ª≠ th√°ch th√∫ v·ªã.
                    </div>
                    <a href="https://aistudio.google.com/app/apps/drive/1rdbjtkD1yn078XU1WoAXx3BTXLNKGbZj?showPreview=true&showAssistant=true" 
                       class="play-button" 
                       target="_blank">
                        <i class="fas fa-play-circle"></i>
                        B·∫Øt ƒë·∫ßu ch∆°i
                    </a>
                </div>

                <!-- Game 2 -->
                <div class="game-card">
                    <div class="game-icon">
                        <i class="fas fa-lightbulb"></i>
                    </div>
                    <div class="game-title">
                        <i class="fas fa-graduation-cap"></i>
                        AI Khoa H·ªçc S√°ng T·∫°o
                    </div>
                    <div class="game-description">
                        Tr·∫£i nghi·ªám c√°c th√≠ nghi·ªám ·∫£o v√† kh√°m ph√° ki·∫øn th·ª©c khoa h·ªçc qua tr√≤ ch∆°i t∆∞∆°ng t√°c. H·ªçc m√† ch∆°i, ch∆°i m√† h·ªçc!
                    </div>
                    <a href="https://ai.studio/apps/drive/1Oug7omqiY8Xz-VxYyHkyrpfV3-1sqmQr" 
                       class="play-button" 
                       target="_blank">
                        <i class="fas fa-play-circle"></i>
                        Kh√°m ph√° ngay
                    </a>
                </div>

                <!-- Game 3 -->
                <div class="game-card">
                    <div class="game-icon">
                        <i class="fas fa-puzzle-piece"></i>
                    </div>
                    <div class="game-title">
                        <i class="fas fa-brain"></i>
                        AI T∆∞ Duy Logic
                    </div>
                    <div class="game-description">
                        R√®n luy·ªán t∆∞ duy logic v√† kh·∫£ nƒÉng gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ qua c√°c c√¢u ƒë·ªë th√¥ng minh. Ph√°t tri·ªÉn k·ªπ nƒÉng t∆∞ duy ph·∫£n bi·ªán.
                    </div>
                    <a href="https://aistudio.google.com/apps/drive/14apWIAbhYcaWHWmm9h4rnmAZ-xMSAphZ?fullscreenApplet=true" 
                       class="play-button" 
                       target="_blank">
                        <i class="fas fa-play-circle"></i>
                        Th·ª≠ th√°ch ngay
                    </a>
                </div>
            </div>
        </div>

        <!-- Subject Buttons Section -->
        <div class="section-title" style="margin-top: 40px;">
            <i class="fas fa-book-open"></i>
            CH·ªåN M√îN H·ªåC ƒê·ªÇ B·∫ÆT ƒê·∫¶U
        </div>

        <div class="subject-buttons">
            <button class="subject-button" data-subject="ngu-van">
                <i class="fas fa-book-open"></i>
                Ng·ªØ VƒÉn
            </button>
            <button class="subject-button" data-subject="toan-dai">
                <i class="fas fa-calculator"></i>
                To√°n ƒê·∫°i S·ªë 
            </button>
            <button class="subject-button" data-subject="toan-hinh">
                <i class="fas fa-shapes"></i>
                To√°n H√¨nh H·ªçc
            </button>
            <button class="subject-button" data-subject="anh-van">
                <i class="fas fa-globe"></i>
                Anh VƒÉn
            </button>
            <button class="subject-button" data-subject="khtn">
                <i class="fas fa-flask"></i>
                Khoa H·ªçc T·ª± Nhi√™n
            </button>
            <button class="subject-button" data-subject="lich-su-dia-ly">
                <i class="fas fa-map-marked-alt"></i>
                L·ªãch S·ª≠ & ƒê·ªãa L√Ω
            </button>
            <button class="subject-button" data-subject="tin-hoc">
                <i class="fas fa-laptop-code"></i>
                Tin H·ªçc
            </button>
            <button class="subject-button" data-subject="hdtn-hn">
                <i class="fas fa-hands-helping"></i>
                Ho·∫°t ƒê·ªông Tr·∫£i Nghi·ªám - H∆∞·ªõng Nghi·ªáp 
            </button>
            <button class="subject-button" data-subject="gdcd">
                <i class="fas fa-balance-scale"></i>
                Gi√°o D·ª•c C√¥ng D√¢n 
            </button>
            <button class="subject-button" data-subject="giao-duc-dia-phuong">
                <i class="fas fa-map"></i>
                Gi√°o D·ª•c ƒê·ªãa Ph∆∞∆°ng
            </button>
            <button class="subject-button" data-subject="cong-nghe">
                <i class="fas fa-robot"></i>
                C√¥ng Ngh·ªá
            </button>
        </div>
    </div>

    <div id="chatbot-container">
        <div id="sidebar">
            <h3>M√¥n h·ªçc</h3>
            <button class="sidebar-button" data-subject="ngu-van">
                <i class="fas fa-book-open"></i>
                Ng·ªØ VƒÉn
            </button>
            <button class="sidebar-button" data-subject="toan-dai">
                <i class="fas fa-calculator"></i>
                To√°n ƒê·∫°i S·ªë
            </button>
            <button class="sidebar-button" data-subject="toan-hinh">
                <i class="fas fa-shapes"></i>
                To√°n H√¨nh H·ªçc
            </button>
            <button class="sidebar-button" data-subject="anh-van">
                <i class="fas fa-globe"></i>
                Anh VƒÉn
            </button>
            <button class="sidebar-button" data-subject="khtn">
                <i class="fas fa-flask"></i>
                Khoa H·ªçc T·ª± Nhi√™n
            </button>
            <button class="sidebar-button" data-subject="lich-su-dia-ly">
                <i class="fas fa-map-marked-alt"></i>
                L·ªãch S·ª≠ & ƒê·ªãa L√Ω
            </button>
            <button class="sidebar-button" data-subject="tin-hoc">
                <i class="fas fa-laptop-code"></i>
                Tin H·ªçc
            </button>
            <button class="sidebar-button" data-subject="hdtn-hn">
                <i class="fas fa-hands-helping"></i>
                HƒêHN - TN
            </button>
            <button class="sidebar-button" data-subject="gdcd">
                <i class="fas fa-balance-scale"></i>
                Gi√°o D·ª•c C√¥ng D√¢n 
            </button>
            <button class="sidebar-button" data-subject="giao-duc-dia-phuong">
                <i class="fas fa-map"></i>
                Gi√°o D·ª•c ƒê·ªãa Ph∆∞∆°ng
            </button>
            <button class="sidebar-button" data-subject="cong-nghe">
                <i class="fas fa-robot"></i>
                C√¥ng Ngh·ªá
            </button>
        </div>
        <div class="chat-area">
            <div id="khung-tro-chuyen">
            </div>
            <div id="khu-vuc-nhap">
                <input type="text" id="o-nhap-tin-nhan" placeholder="H·ªèi th·∫ßy/c√¥ ƒëi·ªÅu g√¨ ƒë√≥...">
                <button id="nut-gui">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
        </div>
    </div>
    
    <div class="footer">
        <div class="footer-content">
           </div>
    </div>

    <script type="importmap">
        {
            "imports": {
                "@google/generative-ai": "https://esm.run/@google/generative-ai"
            }
        }
    </script>
    <script type="module">
        import { GoogleGenerativeAI } from "@google/generative-ai";

        // Thay th·∫ø "YOUR_API_KEY" b·∫±ng kh√≥a API th·ª±c t·∫ø c·ªßa b·∫°n
        const KHOA_API =" AIzaSyCG6upxJ12_6E3gvO3ZeWSS-EICNXVjx6I
"; 
        const moHinhAI = new GoogleGenerativeAI(KHOA_API);
        const moHinh = moHinhAI.getGenerativeModel({ model: "gemini-3-pro-preview" });

        const homeMenu = document.getElementById('home-menu');
        const chatbotContainer = document.getElementById('chatbot-container');
        const khungTroChuyen = document.getElementById('khung-tro-chuyen');
        const oNhapTinNhan = document.getElementById('o-nhap-tin-nhan');
        const nutGui = document.getElementById('nut-gui');
        const subjectButtons = document.querySelectorAll('.subject-button');
        const sidebarButtons = document.querySelectorAll('.sidebar-button');

        let currentSubject = '';
        let homeworkData = {};
        let currentQuestion = null;
        let currentAnswer = null;
        
        // ƒê·ªãnh nghƒ©a c√°c m√¥n h·ªçc v√† b·ªô l·ªçc
        const subjectFilters = {
            "ngu-van": {
                name: "Ng·ªØ VƒÉn",
                excludeKeywords: [
                    "vƒÉn", "t√°c gi·∫£", "t√°c ph·∫©m", "th∆°", "truy·ªán", "ca dao", 
                    "t·ª•c ng·ªØ", "c√¢u", "t·ª´", "ƒëo·∫°n", "nh√¢n v·∫≠t", "n·ªôi dung", 
                    "ch·ªß ƒë·ªÅ", "ngh·ªá thu·∫≠t", "ph√¢n t√≠ch", "c·∫£m nh·∫≠n", "m·ªü b√†i", "k·∫øt b√†i", "VƒÉn", "T√°c gi·∫£", "T√°c ph·∫©m", "Th∆°", "Truy·ªán", "Ca dao", "T·ª•c ng·ªØ", "C√¢u", "T·ª´", "ƒêo·∫°n", "Nh√¢n v·∫≠t", "N·ªôi dung", "Ch·ªß ƒë·ªÅ", "Ngh·ªá thu·∫≠t", "Ph√¢n t√≠ch", "C·∫£m nh·∫≠n", "M·ªü b√†i", "K·∫øt b√†i"
                ],
                homeworkExamples: []
            },
            "toan-dai": {
                name: "To√°n ƒê·∫°i S·ªë",
                excludeKeywords: [
                    "h√¨nh", "g√≥c", "ƒë∆∞·ªùng tr√≤n", "tam gi√°c", "t·ª© gi√°c", 
                    "ƒë∆∞·ªùng th·∫≥ng", "ƒë∆∞·ªùng cong", "ƒë∆∞·ªùng k√≠nh", "b√°n k√≠nh",
                    "chu vi", "di·ªán t√≠ch", "th·ªÉ t√≠ch", "h√¨nh kh√¥ng gian",
                    "h√¨nh h·ªçc", "h√¨nh chi·∫øu", "ƒë·ªìng d·∫°ng", "H√¨nh", "G√≥c", 
                    "ƒê∆∞·ªùng tr√≤n", "Tam gi√°c", "T·ª© gi√°c", "ƒê∆∞·ªùng th·∫≥ng", 
                    "ƒê∆∞·ªùng cong", "ƒê∆∞·ªùng k√≠nh", "B√°n k√≠nh", "Chu vi", 
                    "Di·ªán t√≠ch", "Th·ªÉ t√≠ch", "H√¨nh kh√¥ng gian", "H√¨nh h·ªçc", 
                    "H√¨nh chi·∫øu", "ƒê·ªìng d·∫°ng"
                ],
                homeworkExamples: []
            },
            "toan-hinh": {
                name: "To√°n H√¨nh H·ªçc",
                excludeKeywords: [
                    "ph∆∞∆°ng tr√¨nh", "bi·ªÉu th·ª©c", "ƒëa th·ª©c", "h√†m s·ªë", 
                    "ƒë·ªì th·ªã", "b·∫•t ph∆∞∆°ng tr√¨nh", "t·ªâ l·ªá", "ph√¢n s·ªë", 
                    "s·ªë th·∫≠p ph√¢n", "s·ªë nguy√™n", "cƒÉn b·∫≠c", "logarit", 
                    "l≈©y th·ª´a", "ƒë·∫°i s·ªë", "Ph∆∞∆°ng tr√¨nh", "Bi·ªÉu th·ª©c", 
                    "ƒêa th·ª©c", "H√†m s·ªë", "ƒê·ªì th·ªã", "B·∫•t ph∆∞∆°ng tr√¨nh", 
                    "T·ªâ l·ªá", "Ph√¢n s·ªë", "S·ªë th·∫≠p ph√¢n", "S·ªë nguy√™n", 
                    "CƒÉn b·∫≠c", "Logarit", "L≈©y th·ª´a", "ƒê·∫°i s·ªë"
                ],
                homeworkExamples: []
            },
            "anh-van": {
                name: "Anh VƒÉn",
                excludeKeywords: [
                    "anh", "t·ª´ v·ª±ng", "c·∫•u tr√∫c", "t·ª´", "nghƒ©a", "d·ªãch", "vi·ªát", 
                    "ph√°t √¢m", "ti·∫øng", "ƒë·ªçc hi·ªÉu", "c√¢u ƒëi·ªÅu ki·ªán", "th√¨ hi·ªán t·∫°i", 
                    "th√¨ qu√° kh·ª©", "will", "can", "must", "should", "how", "what", 
                    "where", "when", "why", "who", "tr·∫Øc nghi·ªám ti·∫øng anh", "Anh", "T·ª´ v·ª±ng", "C·∫•u tr√∫c", "T·ª´", "Nghƒ©a", "D·ªãch", "Vi·ªát",
                    "Ph√°t √¢m", "Ti·∫øng", "ƒê·ªçc hi·ªÉu", "C√¢u ƒëi·ªÅu ki·ªán", "Th√¨ hi·ªán t·∫°i",
                    "Th√¨", "Will", "Can", "Must", "Should", "How", "What",
                    "Where", "When", "Why", "Who", "Tr·∫Øc nghi·ªám ti·∫øng anh" 
                ],
                homeworkExamples: []
            },
            "khtn": {
                name: "Khoa H·ªçc T·ª± Nhi√™n",
                excludeKeywords: [
                    "l√Ω", "h√≥a", "sinh", "hi·ªán t∆∞·ª£ng", "nhi·ªát ƒë·ªô", 
                    "l·ª±c", "√°nh s√°ng", "√¢m thanh", "ph·∫£n ·ª©ng", "ch·∫•t", 
                    "h·ªón h·ª£p", "c∆° th·ªÉ", "th·ª±c v·∫≠t", "ƒë·ªông v·∫≠t", "t·∫ø b√†o", 
                    "th√≠ nghi·ªám", "n∆∞·ªõc", "kh√≠", "ƒëi·ªán", "nam ch√¢m", "L√Ω", "H√≥a", "Sinh", "Hi·ªán t∆∞·ª£ng", "Nhi·ªát ƒë·ªô", "L·ª±c", "√Ånh s√°ng", "√Çm thanh", "Ph·∫£n ·ª©ng", "Ch·∫•t", "H·ªón h·ª£p", "C∆° th·ªÉ", "Th·ª±c v·∫≠t", "ƒê·ªông v·∫≠t", "T·∫ø b√†o", "Th√≠ nghi·ªám", "N∆∞·ªõc", "Kh√≠", "ƒêi·ªán", "Nam ch√¢m"
                ],
                homeworkExamples: [],
                chemistryNaming: "english"
            },
            "lich-su-dia-ly": {
                name: "L·ªãch S·ª≠ & ƒê·ªãa L√Ω",
                excludeKeywords: [
                    "chi·∫øn tranh", "c√°ch m·∫°ng", "vua", "tri·ªÅu ƒë·∫°i", "b·∫£n ƒë·ªì", 
                    "ch√¢u l·ª•c", "qu·ªëc gia", "s·ª≠", "ƒë·ªãa", "d√¢n c∆∞", 
                    "ƒë·ªãa h√¨nh", "kh√≠ h·∫≠u", "bi·ªÉn ƒë·∫£o", "nh√¢n d√¢n", "th·ªùi k·ª≥", 
                    "th√†nh t·ª±u", "l∆∞·ª£c ƒë·ªì", "m·ªëc th·ªùi gian", "Chi·∫øn tranh", "C√°ch m·∫°ng", "Vua", "Tri·ªÅu ƒë·∫°i", "B·∫£n ƒë·ªì", "Ch√¢u l·ª•c", "Qu·ªëc gia", "S·ª≠", "ƒê·ªãa", "D√¢n c∆∞", "ƒê·ªãa h√¨nh", "Kh√≠ h·∫≠u", "Bi·ªÉn ƒë·∫£o", "Nh√¢n d√¢n", "Th·ªùi k·ª≥", "Th√†nh t·ª±u", "L∆∞·ª£c ƒë·ªì", "M·ªëc th·ªùi gian"
                ],
                homeworkExamples: []
            },
            "tin-hoc": {
                name: "Tin H·ªçc",
                excludeKeywords: [
                    "m√°y t√≠nh", "b√†n ph√≠m", "chu·ªôt", "t·ªáp", "th∆∞ m·ª•c", "h·ªá ƒëi·ªÅu h√†nh", 
                    "sao ch√©p", "l∆∞u t·ªáp", "PowerPoint", "Word", "Excel", 
                    "l·∫≠p tr√¨nh", "thu·∫≠t to√°n", "v·∫Ω s∆° ƒë·ªì", "ng√¥n ng·ªØ Scratch", "tin", "M√°y t√≠nh", "B√†n ph√≠m", "Chu·ªôt", "T·ªáp", "Th∆∞ m·ª•c", "H·ªá ƒëi·ªÅu h√†nh", "Sao ch√©p", "L∆∞u t·ªáp", "powerPoint", "word", "excel", "L·∫≠p tr√¨nh", "Thu·∫≠t to√°n", "V·∫Ω s∆° ƒë·ªì", "Ng√¥n ng·ªØ", "Tin"
                ],
                homeworkExamples: []
            },
            "hdtn-hn": {
                name: "Ho·∫°t ƒê·ªông Tr·∫£i Nghi·ªám - H∆∞·ªõng Nghi·ªáp",
                excludeKeywords: [
                    "tr·∫£i nghi·ªám", "ho·∫°t ƒë·ªông nh√≥m", "k·ªπ nƒÉng s·ªëng", "lao ƒë·ªông", 
                    "gi√∫p ƒë·ª°", "giao ti·∫øp", "thuy·∫øt tr√¨nh", "ƒë·ªãnh h∆∞·ªõng", "ngh·ªÅ nghi·ªáp", 
                    "t·ª± ƒë√°nh gi√°", "ho·∫°t ƒë·ªông ngo√†i gi·ªù", "ph·ªëi h·ª£p", "Tr·∫£i nghi·ªám", "Ho·∫°t ƒë·ªông nh√≥m", "K·ªπ nƒÉng s·ªëng", "Lao ƒë·ªông", "Gi√∫p ƒë·ª°", "Giao ti·∫øp", "Thuy·∫øt tr√¨nh", "ƒê·ªãnh h∆∞·ªõng", "Ngh·ªÅ nghi·ªáp", "T·ª± ƒë√°nh gi√°", "Ho·∫°t ƒë·ªông ngo√†i gi·ªù", "Ph·ªëi h·ª£p"
                ],
                homeworkExamples: []
            },
            "gdcd": {
                name: "Gi√°o D·ª•c C√¥ng D√¢n",
                excludeKeywords: [
                    "quy·ªÅn", "nghƒ©a v·ª•", "ph√°p lu·∫≠t", "c√¥ng d√¢n", "tr√°ch nhi·ªám", 
                    "ƒë·∫°o ƒë·ª©c", "k·ªâ lu·∫≠t", "t√¥n tr·ªçng", "y√™u n∆∞·ªõc", "l·ªÖ ph√©p", 
                    "trung th·ª±c", "ƒëo√†n k·∫øt", "b·∫£o v·ªá m√¥i tr∆∞·ªùng", "ph√≤ng ch·ªëng", "gdcd", "Quy·ªÅn", "Nghƒ©a v·ª•", "Ph√°p lu·∫≠t", "C√¥ng d√¢n", "Tr√°ch nhi·ªám", "ƒê·∫°o ƒë·ª©c", "K·ªâ lu·∫≠t", "T√¥n tr·ªçng", "Y√™u n∆∞·ªõc", "L·ªÖ ph√©p", "Trung th·ª±c", "ƒêo√†n k·∫øt", "B·∫£o v·ªá m√¥i tr∆∞·ªùng", "Ph√≤ng ch·ªëng", "Gdcd"
                ],
                homeworkExamples: []
            },
            "giao-duc-dia-phuong": {
                name: "Gi√°o D·ª•c ƒê·ªãa Ph∆∞∆°ng",
                excludeKeywords: [
                    "ƒë·ªãa ph∆∞∆°ng", "t·ªânh", "th√†nh ph·ªë", "l·ªãch s·ª≠ ƒë·ªãa ph∆∞∆°ng", 
                    "vƒÉn h√≥a ƒë·ªãa ph∆∞∆°ng", "l·ªÖ h·ªôi", "truy·ªÅn th·ªëng", "nh√¢n v·∫≠t ti√™u bi·ªÉu", 
                    "di t√≠ch", "ƒë·∫∑c s·∫£n", "n√©t ƒë·∫πp qu√™ h∆∞∆°ng", "ƒê·ªãa ph∆∞∆°ng", "T·ªânh", "Th√†nh ph·ªë", "L·ªãch s·ª≠ ƒë·ªãa ph∆∞∆°ng", "VƒÉn h√≥a ƒë·ªãa ph∆∞∆°ng", "L·ªÖ h·ªôi", "Truy·ªÅn th·ªëng", "Nh√¢n v·∫≠t ti√™u bi·ªÉu", "Di t√≠ch", "ƒê·∫∑c s·∫£n", "N√©t ƒë·∫πp qu√™ h∆∞∆°ng"
                ],
                homeworkExamples: []
            },
            "cong-nghe": {
                name: "C√¥ng Ngh·ªá",
                excludeKeywords: [
                    "d·ªát may", "tr·ªìng tr·ªçt", "chƒÉn nu√¥i", "m·∫°ng ƒëi·ªán", 
                    "s∆° ƒë·ªì", "d·ª•ng c·ª•", "v·∫≠t li·ªáu", "k·ªπ thu·∫≠t", 
                    "m√°y m√≥c", "c√¥ng c·ª•", "k·∫ø ho·∫°ch", "an to√†n", 
                    "gi·ªëng c√¢y", "th·ª©c ƒÉn", "h·ªá th·ªëng", "v·∫Ω k·ªπ", 
                    "c√¥ng ngh·ªá", "D·ªát may", "Tr·ªìng tr·ªçt", "ChƒÉn nu√¥i", 
                    "M·∫°ng ƒëi·ªán", "S∆° ƒë·ªì", "D·ª•ng c·ª•", "V·∫≠t li·ªáu", 
                    "K·ªπ thu·∫≠t", "M√°y m√≥c", "C√¥ng c·ª•", "K·∫ø ho·∫°ch", 
                    "An to√†n", "Gi·ªëng c√¢y", "Th·ª©c ƒÉn", "H·ªá th·ªëng", 
                    "V·∫Ω k·ªπ", "C√¥ng ngh·ªá"
                ],
                homeworkExamples: []
            }
        };

        const generalExcludeKeywords = [
            "ƒë·∫°i h·ªçc", "cao h·ªçc", "nghi√™n c·ª©u", "ph√¢n t√≠ch chuy√™n s√¢u", "tri·∫øt h·ªçc",
            "kinh t·∫ø vƒ© m√¥", "ch√≠nh tr·ªã qu·ªëc t·∫ø", "ch·ª©ng minh n√¢ng cao", "ph·∫£n bi·ªán"
        ];

        // C√°c c·ª•m t·ª´ ng∆∞·ªùi d√πng c√≥ th·ªÉ d√πng ƒë·ªÉ y√™u c·∫ßu b√†i t·∫≠p
        const homeworkRequestPhrases = /(cho (t√¥i|em) b√†i t·∫≠p|xin b√†i t·∫≠p|g·ª£i √Ω b√†i t·∫≠p|b√†i t·∫≠p v·ªÅ|cho b√†i t·∫≠p|ƒë∆∞a b√†i t·∫≠p|ƒë∆∞a (t√¥i|em) b√†i t·∫≠p)/;

        function themTinNhanVaoGiaoDien(nguoiGui, vanBan) {
            const divTinNhan = document.createElement('div');
            divTinNhan.classList.add('tin-nhan', `tin-nhan-${nguoiGui}`);
            divTinNhan.innerHTML = vanBan.replace(/\n/g, '<br>');
            khungTroChuyen.appendChild(divTinNhan);
            khungTroChuyen.scrollTop = khungTroChuyen.scrollHeight;
        }

        async function loadHomeworkData() {
            try {
                console.log("ƒêang t·∫£i d·ªØ li·ªáu b√†i t·∫≠p...");
                const response = await fetch('baitap.txt');
                if (!response.ok) throw new Error(`L·ªói HTTP! status: ${response.status}`);
                
                const text = await response.text();
                console.log("N·ªôi dung file:", text); // Ki·ªÉm tra n·ªôi dung file
                
                const lines = text.split('\n')
                    .map(line => line.trim())
                    .filter(line => line.length > 0 && !line.startsWith('//'));

                let currentSection = '';
                homeworkData = {};
                
                for (const line of lines) {
                    if (line.startsWith('#')) {
                        currentSection = line.substring(1).trim();
                        homeworkData[currentSection] = [];
                    } else if (currentSection && line.includes('|')) {
                        const parts = line.split('|').map(part => part.trim());
                        if (parts.length === 2) {
                            homeworkData[currentSection].push({
                                question: parts[0].replace('C√¢u h·ªèi:', '').trim(),
                                answer: parts[1].replace('ƒê√°p √°n:', '').trim()
                            });
                        }
                    }
                }

                // C·∫≠p nh·∫≠t v√†o subjectFilters
                for (const subjectKey in homeworkData) {
                    if (subjectFilters[subjectKey]) {
                        subjectFilters[subjectKey].homeworkExamples = homeworkData[subjectKey];
                        console.log(`ƒê√£ t·∫£i ${homeworkData[subjectKey].length} b√†i t·∫≠p cho m√¥n ${subjectKey}`);
                    }
                }
            } catch (error) {
                console.error("L·ªói khi t·∫£i d·ªØ li·ªáu b√†i t·∫≠p:", error);
                // Kh·ªüi t·∫°o homeworkExamples r·ªóng n·∫øu c√≥ l·ªói
                for (const key in subjectFilters) {
                    subjectFilters[key].homeworkExamples = [];
                }
            }
        }

        // H√†m l·∫•y c√¢u h·ªèi ng·∫´u nhi√™n
        function getRandomQuestion(subject) {
            if (!subjectFilters[subject] || !subjectFilters[subject].homeworkExamples || 
                subjectFilters[subject].homeworkExamples.length === 0) {
                return null;
            }
            const questions = subjectFilters[subject].homeworkExamples;
            const randomIndex = Math.floor(Math.random() * questions.length);
            return questions[randomIndex];
        }

        function selectSubject(subject) {
            currentSubject = subject;
            homeMenu.style.display = 'none';
            chatbotContainer.style.display = 'flex';
            khungTroChuyen.innerHTML = '';
            
            // Reset c√¢u h·ªèi hi·ªán t·∫°i
            currentQuestion = null;
            currentAnswer = null;
            
            themTinNhanVaoGiaoDien("bot", 
                `Ch√†o em! Th·∫ßy/c√¥ s·∫µn s√†ng h·ªó tr·ª£ em h·ªçc m√¥n <strong>${subjectFilters[subject].name}</strong>. ` +
                `Em c√≥ th·ªÉ h·ªèi b√†i ho·∫∑c nh·∫Øn "cho em b√†i t·∫≠p" ƒë·ªÉ nh·∫≠n c√¢u h·ªèi nh√©!`);

            // C·∫≠p nh·∫≠t active state cho sidebar
            sidebarButtons.forEach(button => {
                button.classList.toggle('active', button.dataset.subject === subject);
            });
        }

        // G·∫Øn s·ª± ki·ªán khi trang t·∫£i xong
        document.addEventListener('DOMContentLoaded', () => {
            // G·∫Øn s·ª± ki·ªán cho c√°c n√∫t m√¥n h·ªçc
            subjectButtons.forEach(button => {
                button.addEventListener('click', () => selectSubject(button.dataset.subject));
            });
            
            sidebarButtons.forEach(button => {
                button.addEventListener('click', () => selectSubject(button.dataset.subject));
            });
            
            // G·∫Øn s·ª± ki·ªán g·ª≠i tin nh·∫Øn
            nutGui.addEventListener('click', guiTinNhan);
            oNhapTinNhan.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') guiTinNhan();
            });
            
            // T·∫£i d·ªØ li·ªáu b√†i t·∫≠p khi kh·ªüi ƒë·ªông
            loadHomeworkData();
            
            // Th√™m hi·ªáu ·ª©ng cho c√°c th·∫ª tr√≤ ch∆°i
            const gameCards = document.querySelectorAll('.game-card');
            gameCards.forEach(card => {
                card.addEventListener('mouseenter', function() {
                    const icon = this.querySelector('.game-icon i');
                    icon.style.transform = 'scale(1.2) rotate(10deg)';
                });
                
                card.addEventListener('mouseleave', function() {
                    const icon = this.querySelector('.game-icon i');
                    icon.style.transform = 'scale(1) rotate(0deg)';
                });
            });
        });

        async function guiTinNhan() {
            const tinNhanNguoiDung = oNhapTinNhan.value.trim();
            if (!tinNhanNguoiDung) return;

            themTinNhanVaoGiaoDien("nguoi-dung", tinNhanNguoiDung);
            oNhapTinNhan.value = '';

            // X·ª≠ l√Ω l·ªùi ch√†o
            if (["ch√†o"].some(word => tinNhanNguoiDung.toLowerCase().includes(word))) {
                themTinNhanVaoGiaoDien("bot", `Ch√†o em! Th·∫ßy/c√¥ s·∫µn s√†ng h·ªó tr·ª£ em h·ªçc m√¥n **${subjectFilters[currentSubject].name}**. Em c·∫ßn th·∫ßy/c√¥ gi·∫£i ƒë√°p g√¨ ho·∫∑c mu·ªën l√†m b√†i t·∫≠p n√†o?`);
                return;
            }

            // X·ª≠ l√Ω y√™u c·∫ßu ƒë√°p √°n
            if (tinNhanNguoiDung.toLowerCase().includes('ƒë√°p √°n')) {
                if (currentAnswer) {
                    themTinNhanVaoGiaoDien("bot", `ƒê√°p √°n: ${currentAnswer}`);
                } else {
                    themTinNhanVaoGiaoDien("bot", "Hi·ªán kh√¥ng c√≥ c√¢u h·ªèi n√†o ƒë∆∞·ª£c ch·ªçn. Em h√£y y√™u c·∫ßu m·ªôt b√†i t·∫≠p tr∆∞·ªõc nh√©!");
                }
                return;
            }

            // X·ª≠ l√Ω y√™u c·∫ßu b√†i t·∫≠p
            const isAskingForHomework = /(cho (t√¥i|em) b√†i t·∫≠p|xin b√†i t·∫≠p|g·ª£i √Ω b√†i t·∫≠p|b√†i t·∫≠p)/i.test(tinNhanNguoiDung);
            if (isAskingForHomework) {
                if (currentSubject && subjectFilters[currentSubject] && 
                    subjectFilters[currentSubject].homeworkExamples && 
                    subjectFilters[currentSubject].homeworkExamples.length > 0) {
                    
                    const randomQuestion = getRandomQuestion(currentSubject);
                    if (randomQuestion) {
                        currentQuestion = randomQuestion.question;
                        currentAnswer = randomQuestion.answer;
                        themTinNhanVaoGiaoDien("bot", 
                            `Th·∫ßy/c√¥ c√≥ b√†i t·∫≠p m√¥n **${subjectFilters[currentSubject].name}** cho em:\n\n` +
                            `üìù ${currentQuestion}\n\n` +
                            `Em h√£y th·ª≠ gi·∫£i v√† nh·∫Øn "ƒë√°p √°n" n·∫øu mu·ªën xem ƒë√°p √°n nh√©!`);
                    } else {
                        themTinNhanVaoGiaoDien("bot", "Hi·ªán kh√¥ng c√≥ b√†i t·∫≠p n√†o trong danh s√°ch. Vui l√≤ng th·ª≠ l·∫°i sau!");
                    }
                } else {
                    themTinNhanVaoGiaoDien("bot", "Ch√†o em! Hi·ªán t·∫°i th·∫ßy/c√¥ ch∆∞a c√≥ b√†i t·∫≠p s·∫µn cho m√¥n n√†y. Em c√≥ mu·ªën th·∫ßy/c√¥ g·ª£i √Ω m·ªôt d·∫°ng b√†i t·∫≠p ho·∫∑c gi·∫£i ƒë√°p c√¢u h·ªèi n√†o kh√¥ng?");
                }
                return;
            }

            // X·ª≠ l√Ω c√°c c√¢u h·ªèi th√¥ng th∆∞·ªùng
            try {
                let loiNhac = `B·∫°n l√† m·ªôt gi√°o vi√™n AI th√¢n thi·ªán, h·ªó tr·ª£ h·ªçc sinh THCS tr∆∞·ªùng Nguy·ªÖn Tri Ph∆∞∆°ng (x∆∞ng h√¥ l√† th·∫ßy/c√¥ v·ªõi h·ªçc sinh l√† em). B·∫°n chuy√™n gi·∫£i ƒë√°p c√¢u h·ªèi v√† g·ª£i √Ω c√°ch l√†m b√†i t·∫≠p cho h·ªçc sinh THCS trong m√¥n ${subjectFilters[currentSubject].name} theo ch∆∞∆°ng tr√¨nh gi√°o d·ª•c m·ªõi. H√£y tr·∫£ l·ªùi ng·∫Øn g·ªçn, d·ªÖ hi·ªÉu, ph√π h·ª£p v·ªõi tr√¨nh ƒë·ªô THCS (l·ªõp 6-9).`;
                
                // Th√™m c√°c h∆∞·ªõng d·∫´n ƒë·∫∑c bi·ªát cho t·ª´ng m√¥n h·ªçc
                if (currentSubject === "khtn") {
                    loiNhac += "\n\nL∆ØU √ù QUAN TR·ªåNG: Khi gi·∫£i ƒë√°p v·ªÅ h√≥a h·ªçc, lu√¥n s·ª≠ d·ª•ng t√™n ti·∫øng Anh c·ªßa c√°c nguy√™n t·ªë v√† h·ª£p ch·∫•t.";
                }
                
                if (currentSubject === "toan-dai" || currentSubject === "toan-hinh") {
                    loiNhac += "\n\nL∆ØU √ù QUAN TR·ªåNG: Khi tr·∫£ l·ªùi c√¢u h·ªèi to√°n h·ªçc:";
                    loiNhac += "\n1. D√πng t·ª´ ng·ªØ ƒë∆°n gi·∫£n, r√µ r√†ng";
                    loiNhac += "\n2. Vi·∫øt c√¥ng th·ª©c ch·ªâ s·ª≠ d·ª•ng k√≠ hi·ªáu to√°n h·ªçc th√¥ng th∆∞·ªùng";
                    
                    if (currentSubject === "toan-hinh") {
                        loiNhac += "\n3. LU√îN m√¥ t·∫£ h√¨nh v·∫Ω b·∫±ng text n·∫øu c·∫ßn";
                    }
                }
                
                loiNhac += `\n\nC√¢u h·ªèi: ${tinNhanNguoiDung}`;

                const ketQua = await moHinh.generateContent(loiNhac);
                const phanHoi = await ketQua.response;
                const traLoiBot = phanHoi.text();
                themTinNhanVaoGiaoDien("bot", traLoiBot);

                // Ki·ªÉm tra c·∫£nh b√°o cho m√¥n to√°n
                if ((currentSubject === "toan-dai" || currentSubject === "toan-hinh") && kiemTraToan(traLoiBot)) {
                    themTinNhanVaoGiaoDien("bot", 
                        "‚ö†Ô∏è Em l∆∞u √Ω: K·∫øt qu·∫£ n√†y c·∫ßn ƒë∆∞·ª£c ki·ªÉm tra l·∫°i k·ªπ. " +
                        "N√™n tham kh·∫£o √Ω ki·∫øn th·∫ßy c√¥ tr·ª±c ti·∫øp ƒë·ªÉ x√°c minh.");
                }

            } catch (loi) {
                console.error("L·ªói khi g·ªçi API Gemini: ", loi);
                themTinNhanVaoGiaoDien("bot", "R·∫•t ti·∫øc, c√≥ l·ªói x·∫£y ra. Em vui l√≤ng th·ª≠ l·∫°i sau nh√©!");
            }
        }

        function kiemTraToan(noiDung) {
            const canhBao = [
                "k·∫øt qu·∫£ ch∆∞a ch√≠nh x√°c",
                "c·∫ßn ki·ªÉm tra l·∫°i",
                "ph∆∞∆°ng ph√°p n√†y c√≥ th·ªÉ sai",
                "v∆∞·ª£t qu√° ch∆∞∆°ng tr√¨nh THCS"
            ];
            
            // Th√™m c·∫£nh b√°o ƒë·∫∑c bi·ªát cho h√¨nh h·ªçc
            if (currentSubject === "toan-hinh") {
                canhBao.push("h√¨nh v·∫Ω c√≥ th·ªÉ kh√¥ng ch√≠nh x√°c");
                canhBao.push("c·∫ßn ki·ªÉm tra l·∫°i gi·∫£ thi·∫øt");
            }
            
            // Th√™m c·∫£nh b√°o ƒë·∫∑c bi·ªát cho ƒë·∫°i s·ªë
            if (currentSubject === "toan-dai") {
                canhBao.push("c·∫ßn ki·ªÉm tra l·∫°i ph√©p bi·∫øn ƒë·ªïi");
                canhBao.push("ƒëi·ªÅu ki·ªán x√°c ƒë·ªãnh ch∆∞a ƒë·∫ßy ƒë·ªß");
            }
            
            return canhBao.some(tu => noiDung.includes(tu));
        }

        /**
         * Ki·ªÉm tra xem c√¢u h·ªèi c√≥ ph√π h·ª£p v·ªõi c·∫•p ƒë·ªô THCS hay kh√¥ng.
         * @param {string} cauHoi - C√¢u h·ªèi c·ªßa ng∆∞·ªùi d√πng.
         * @returns {boolean} - True n·∫øu ph√π h·ª£p, False n·∫øu kh√¥ng.
         */
        function laCauHoiTHCS(cauHoi) {
            const cauHoiThuong = cauHoi.toLowerCase();

            // Ki·ªÉm tra c√°c t·ª´ kh√≥a lo·∫°i tr·ª´ chung
            const laKhongTHCSChung = generalExcludeKeywords.some(tuKhoa => cauHoiThuong.includes(tuKhoa));
            if (laKhongTHCSChung) return false;

            // Ki·ªÉm tra c√°c t·ª´ kh√≥a lo·∫°i tr·ª´ theo m√¥n h·ªçc c·ª• th·ªÉ
            if (currentSubject && subjectFilters[currentSubject]) {
                const subjectSpecificKeywords = subjectFilters[currentSubject].excludeKeywords;
                const laKhongTHCSMonHoc = subjectSpecificKeywords.some(tuKhoa => cauHoiThuong.includes(tuKhoa));
                if (laKhongTHCSMonHoc) return false;
            }

            return true;
        }

        // H√†m n√†y kh√¥ng c√≤n quy·∫øt ƒë·ªãnh h√†nh vi ch√≠nh m√† ch·ªâ h·ªó tr·ª£ regex cho homeworkRequestPhrases
        function laYeuCauGiaiBaiTap(cauHoi) {
            const cauHoiThuong = cauHoi.toLowerCase();
            return homeworkRequestPhrases.test(cauHoiThuong);
        }
    </script>
</body>
</html>
